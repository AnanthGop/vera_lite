CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `budget_analysis_1` AS select distinct `a`.`account_code` AS `account_code`,row_number() OVER (ORDER BY `a`.`account_code` )  AS `id`,`b`.`account_name` AS `account_name`,(select distinct `voucher_combination_detail_curr_mnth`.`month_key` from `voucher_combination_detail_curr_mnth`) AS `month_key` from ((select distinct `vouchers_curr_month`.`account_code` AS `account_code` from `vouchers_curr_month` union all select distinct `budget_details`.`account` AS `account` from `budget_details`) `a` join `chart_mapping` `b`) where (`a`.`account_code` = `b`.`account_code`)

create or replace view vera.asset_liability_closevalidation as
select row_number() OVER (ORDER BY `a`.`account_code`,`a`.`account_name` )  AS `id`,`a`.`account_code` AS `account_code`,`a`.`account_name` AS `account_name`,`a`.`amount` AS `amount`,`a`.`account_type` AS `account_type` from (
SELECT account as account_code, description as account_name, opening_balance as amount, account_type FROM vera.monthly_balance where account_type = 'Asset' and opening_balance < 0 and month_key = '2025-08' union all
SELECT account as account_code, description as account_name, opening_balance as amount, account_type FROM vera.monthly_balance where account_type = 'Liability' and opening_balance > 0 and month_key = '2025-08') a where a.account_code not in (select account_code  from vera.close_val_exception where close_val = 'Asset_Liability');